const config = {
  name: "taobox",
  aliases: ["rb",
    "regbox",
    "taobox"],
  description: "T·∫°o box SLL",
  usage: "[s·ªë l∆∞·ª£ng] [t√™n box]",
  cooldown: 3,
  permissions: [2],
  credits: "Nh·∫≠t Ng√°o"
}

if (!global.taobox) global.taobox = new Set();

const DELAY = 450;

async function Running( {
  message, args
}) {
  if (message.senderID != global.botID) return;
  if (message.isGroup) return;

  let isStop = args[0]?.toLowerCase() == "stop";
  message.react("üÉè");
  if (isStop) {
    global.taobox.delete(message.threadID);

    return;
  }

  let amount = parseInt(args[0]) || 1;
  let boxname = args[1] ?? null;

  const groupMembers = [message.senderID,
    message.threadID];
  global.taobox.add(message.threadID);

  for (let i = 0; i < amount; i++) {
    if (!global.taobox.has(message.threadID)) return;

    const newThreadID = await global.api.createNewGroup(groupMembers, boxname);
    global.api.sendMessage("Nh·∫≠t ng√°o xin ch√†o m·∫•y con ƒëƒ© n·ª©ng l·ªìn", newThreadID);

    await new Promise(resolve => setTimeout(resolve, DELAY));
  }
}

export default {
  config,
  Running
}